#!/bin/bash

# Script to remove old recurring functions from miniCycle-scripts.js
# This comments out old functions that have been replaced by modules

SCRIPT_FILE="/Users/mjaynumberone/Documents/Programs/Code/miniCycle/web/miniCycle-scripts.js"
BACKUP_FILE="/Users/mjaynumberone/Documents/Programs/Code/miniCycle/web/miniCycle-scripts.js.backup-before-recurring-removal"

echo "üîÑ Removing old recurring functions from miniCycle-scripts.js"
echo "üìÅ Backup already created at: $BACKUP_FILE"
echo ""

# List of function names to remove (exact matches)
FUNCTIONS_TO_REMOVE=(
    "initializeDefaultRecurringSettings"
    "updateRecurringTemplates"
    "createRecurringNotificationWithTip"
    "initializeRecurringNotificationListeners"
    "applyRecurringToTaskSchema25"
    "updateRecurringPanel"
    "deleteRecurringTemplate"
    "saveAlwaysShowRecurringSetting"
    "loadAlwaysShowRecurringSetting"
    "clearNonRelevantRecurringFields"
    "syncRecurringStateToDOM"
    "updateRecurringButtonVisibility"
    "isAlwaysShowRecurringEnabled"
    "updateRecurringPanelButtonVisibility"
    "updateRecurringSummary"
    "attachRecurringSummaryListeners"
    "populateRecurringFormWithSettings"
    "clearRecurringForm"
    "getRecurringSummaryText"
    "buildRecurringSummaryFromSettings"
    "removeRecurringTasksFromCycle"
    "handleRecurringTasksAfterReset"
    "shouldRecreateRecurringTask"
    "watchRecurringTasks"
    "setupRecurringWatcher"
    "createRecurringTemplate"
    "setupRecurringButtonHandler"
    "handleRecurringTaskActivation"
    "handleRecurringTaskDeactivation"
    "setupRecurringPanel"
    "openRecurringSettingsPanelForTask"
    "updateRecurringSettingsVisibility"
    "loadRecurringSettingsForTask"
    "normalizeRecurringSettings"
    "buildRecurringSettingsFromPanel"
    "parseDateAsLocal"
    "showTaskSummaryPreview"
    "convert12To24"
    "shouldTaskRecurNow"
)

echo "üìã Functions to remove: ${#FUNCTIONS_TO_REMOVE[@]}"
echo ""

# This is a complex task - recommend manual removal or using a more sophisticated tool
echo "‚ö†Ô∏è  RECOMMENDATION: Due to the complexity of function boundaries,"
echo "    it's safer to manually remove functions or use an IDE's refactoring tools."
echo ""
echo "Functions identified for removal are listed in:"
echo "   docs/FUNCTIONS_TO_REMOVE.md"
echo ""
echo "‚úÖ Backup is ready at:"
echo "   $BACKUP_FILE"
echo ""
echo "To rollback if needed:"
echo "   cp $BACKUP_FILE $SCRIPT_FILE"
